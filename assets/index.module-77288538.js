import{_ as S}from"./extends-98964cd2.js";import{r}from"./index-8db94870.js";import{a as h}from"./index.module-75a565db.js";import{a as k,$ as _,d as U}from"./index.module-3064e7bd.js";import{c as y}from"./index.module-6cd25d47.js";function z(s,e=globalThis==null?void 0:globalThis.document){const i=y(s);r.useEffect(()=>{const o=t=>{t.key==="Escape"&&i(t)};return e.addEventListener("keydown",o),()=>e.removeEventListener("keydown",o)},[i,e])}const p="dismissableLayer.update",A="dismissableLayer.pointerDownOutside",K="dismissableLayer.focusOutside";let w;const N=r.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Q=r.forwardRef((s,e)=>{var i;const{disableOutsidePointerEvents:o=!1,onEscapeKeyDown:t,onPointerDownOutside:c,onFocusOutside:b,onInteractOutside:u,onDismiss:l,...v}=s,a=r.useContext(N),[d,L]=r.useState(null),f=(i=d==null?void 0:d.ownerDocument)!==null&&i!==void 0?i:globalThis==null?void 0:globalThis.document,[,x]=r.useState({}),F=k(e,n=>L(n)),O=Array.from(a.layers),[I]=[...a.layersWithOutsidePointerEventsDisabled].slice(-1),R=O.indexOf(I),D=d?O.indexOf(d):-1,W=a.layersWithOutsidePointerEventsDisabled.size>0,m=D>=R,B=H(n=>{const E=n.target,g=[...a.branches].some($=>$.contains(E));!m||g||(c==null||c(n),u==null||u(n),n.defaultPrevented||l==null||l())},f),P=X(n=>{const E=n.target;[...a.branches].some($=>$.contains(E))||(b==null||b(n),u==null||u(n),n.defaultPrevented||l==null||l())},f);return z(n=>{D===a.layers.size-1&&(t==null||t(n),!n.defaultPrevented&&l&&(n.preventDefault(),l()))},f),r.useEffect(()=>{if(d)return o&&(a.layersWithOutsidePointerEventsDisabled.size===0&&(w=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),a.layersWithOutsidePointerEventsDisabled.add(d)),a.layers.add(d),T(),()=>{o&&a.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=w)}},[d,f,o,a]),r.useEffect(()=>()=>{d&&(a.layers.delete(d),a.layersWithOutsidePointerEventsDisabled.delete(d),T())},[d,a]),r.useEffect(()=>{const n=()=>x({});return document.addEventListener(p,n),()=>document.removeEventListener(p,n)},[]),r.createElement(_.div,S({},v,{ref:F,style:{pointerEvents:W?m?"auto":"none":void 0,...s.style},onFocusCapture:h(s.onFocusCapture,P.onFocusCapture),onBlurCapture:h(s.onBlurCapture,P.onBlurCapture),onPointerDownCapture:h(s.onPointerDownCapture,B.onPointerDownCapture)}))});function H(s,e=globalThis==null?void 0:globalThis.document){const i=y(s),o=r.useRef(!1),t=r.useRef(()=>{});return r.useEffect(()=>{const c=u=>{if(u.target&&!o.current){let v=function(){C(A,i,l,{discrete:!0})};const l={originalEvent:u};u.pointerType==="touch"?(e.removeEventListener("click",t.current),t.current=v,e.addEventListener("click",t.current,{once:!0})):v()}o.current=!1},b=window.setTimeout(()=>{e.addEventListener("pointerdown",c)},0);return()=>{window.clearTimeout(b),e.removeEventListener("pointerdown",c),e.removeEventListener("click",t.current)}},[e,i]),{onPointerDownCapture:()=>o.current=!0}}function X(s,e=globalThis==null?void 0:globalThis.document){const i=y(s),o=r.useRef(!1);return r.useEffect(()=>{const t=c=>{c.target&&!o.current&&C(K,i,{originalEvent:c},{discrete:!1})};return e.addEventListener("focusin",t),()=>e.removeEventListener("focusin",t)},[e,i]),{onFocusCapture:()=>o.current=!0,onBlurCapture:()=>o.current=!1}}function T(){const s=new CustomEvent(p);document.dispatchEvent(s)}function C(s,e,i,{discrete:o}){const t=i.originalEvent.target,c=new CustomEvent(s,{bubbles:!1,cancelable:!0,detail:i});e&&t.addEventListener(s,e,{once:!0}),o?U(t,c):t.dispatchEvent(c)}export{Q as $};
//# sourceMappingURL=index.module-77288538.js.map
